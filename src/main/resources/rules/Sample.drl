package com.sample

import javax.swing.JFrame;
import javax.swing.JOptionPane;
import javax.swing.JTextArea;

import org.kie.api.runtime.KieRuntime;
import com.sample.BottleOfWineApp.Info;
import com.sample.BottleOfWineApp.Prompt;
import com.sample.BottleOfWineApp.Question;
import com.sample.BottleOfWineApp.Answer;
import com.sample.BottleOfWineApp;

global JFrame frame;
global JTextArea textarea;

rule "Is working"
	when
	then
		System.out.println("Is working");
end

rule "Ask who drinks"
    when
    	// TODO: Move to condition
        $prompt : Prompt(hasInfo("whoDrinks") == false)
        // FIXME mismatched input $prompt, missmatched input collect
        // forall($i : Info(getQuestion() != "whoDrinks"))
        // from collect($prompt.getInfos()) FIXME: not exists - exists cannot be resolved to an object
        $question : Question(keyword == "whoDrinks")
    then
        // TODO: Move to other function
        // FIXME: insert is undefined in function scope
        // FIXME: No enclosing instance of type BottleOfWineApp is accessible. Must qualify the allocation with an enclosing instance of type BottleOfWineApp (e.g. x.new A() where x is an instance of BottleOfWineApp).	
		// tried removing casting still not work
        Object[] options = $question.getAnswers();
		int n = JOptionPane.showOptionDialog(frame, $question.toString(), "", JOptionPane.YES_NO_OPTION, JOptionPane.QUESTION_MESSAGE, null, options, options[0]);
		Info info = new Info($question, (Answer)options[n]);
		$prompt.addInfo(info);
        update($prompt);
end
